# Summon
execute store result score @s fish_count if entity @e[type=pufferfish,distance=..30]
execute unless score @s fish_count matches 3.. if block ~ ~ ~ water unless score $glowing settings matches 1 run summon pufferfish ~ ~ ~ {Tags:["die_between_games","can_catch","cut_pufferfish"],PuffState:2,active_effects:[{id:"minecraft:resistance",amplifier:127b,duration:1000000,show_particles:0b}]}
execute unless score @s fish_count matches 3.. if block ~ ~ ~ water if score $glowing settings matches 1 run summon pufferfish ~ ~ ~ {Tags:["die_between_games","can_catch","cut_pufferfish"],PuffState:2,Glowing:1b,active_effects:[{id:"minecraft:resistance",amplifier:127b,duration:1000000,show_particles:0b}]}

# Proper glowing colors
execute unless score @s fish_count matches 3.. run team join no_collision @e[type=pufferfish,tag=can_catch,limit=1,sort=nearest,distance=..500]
execute unless score @s fish_count matches 3.. run team join no_collision @e[type=item_display,tag=pufferfish,limit=1,sort=nearest,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 unless entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_1 Recipe{Ingredients:["Cut Pufferfish"]} run tag @e[type=pufferfish,tag=can_catch,distance=..500] add recipe_ingredient
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 unless entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_1 Recipe{Ingredients:["Cut Pufferfish"]} run tag @e[type=item_display,tag=pufferfish,distance=..500] add recipe_ingredient
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 unless entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_1 Recipe{Ingredients:["Cut Pufferfish"]} unless entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_missing @e[type=pufferfish,tag=can_catch,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 unless entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_1 Recipe{Ingredients:["Cut Pufferfish"]} unless entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_missing @e[type=item_display,tag=pufferfish,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 unless entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_1 Recipe{Ingredients:["Cut Pufferfish"]} if entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_filled @e[type=pufferfish,tag=can_catch,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 unless entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_1 Recipe{Ingredients:["Cut Pufferfish"]} if entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_filled @e[type=item_display,tag=pufferfish,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 if entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_2 Recipe{Ingredients:["Cut Pufferfish"]} run tag @e[type=pufferfish,tag=can_catch,distance=..500] add recipe_ingredient
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 if entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_2 Recipe{Ingredients:["Cut Pufferfish"]} run tag @e[type=item_display,tag=pufferfish,distance=..500] add recipe_ingredient
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 if entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_2 Recipe{Ingredients:["Cut Pufferfish"]} unless entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_missing @e[type=pufferfish,tag=can_catch,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 if entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_2 Recipe{Ingredients:["Cut Pufferfish"]} unless entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_missing @e[type=item_display,tag=pufferfish,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 if entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_2 Recipe{Ingredients:["Cut Pufferfish"]} if entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_filled @e[type=pufferfish,tag=can_catch,distance=..500]
execute unless score @s fish_count matches 3.. if score $glowing settings matches 1 if entity @a[gamemode=adventure,tag=playing,tag=team_2,distance=..500] if data storage current_order_2 Recipe{Ingredients:["Cut Pufferfish"]} if entity @e[type=marker,tag=prep_display,limit=1,sort=nearest,distance=..500,tag=cut_pufferfish] run team join recipe_filled @e[type=item_display,tag=pufferfish,distance=..500]